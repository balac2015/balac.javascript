<title>树形视图</title>
<!-- 只使用展开、收缩图标 -->
<link rel="stylesheet" href="../node_modules/bootstrap/css/bootstrap.css">
<script type="text/javascript" src="../node_modules/vue/dist/vue.min.js"></script>

<style>
	.item { cursor: pointer; }
	.bold { font-weight: bold; }
	.node {  line-height: 32px; }
	.node:hover { background-color: #e4e8f1; }
	ul { padding: 0; list-style: none; }
	#demo { padding: 10px; margin: 10px; border: 1px solid #ddd; }
</style>

<ul id="demo">
	<item class="item" :model="treeData" :level="0"></item>
</ul>

<script type="text/x-template" id="tree-template">
    <li>
        <div class="node" :class=" {bold: isFolder} " :style="distStyle(level)" @click=" toggle " @dblclick=" changeType ">
            <i v-if="isFolder" class="glyphicon" :class=" [ !open ? 'glyphicon-chevron-right' : 'glyphicon-chevron-down'] "></i>
            {{ model.name }}
            <span v-if="isFolder">[{{ open ? '-' : '+' }}]</span>
        </div>
        <ul v-show="open" v-if="isFolder">
            <item class="item" v-for="model in model.children" :model="model" :level="1 + level"></item>
            <li class="add" :style="distStyle(1 + level)" @click="addChild">+</li>
        </ul>
    </li>
</script>

<script type="text/javascript">
    var data = {
		name: 'My Tree',
        children: [
            { name: 'hello' },
            { name: 'wat' },
            {
            	name: 'child folder',
                children: [
                    {
                    	name: 'child folder',
                        children: [
                            { name: 'hello' },
                            { name: 'wat' }
                        ]
                    },
                    { name: 'hello' },
                    { name: 'wat' },
                    {
                    	name: 'child folder',
                        children: [
                            { name: 'hello' },
                            { name: 'wat' }
                        ]
                    }
                ]
            }
        ]
    };

	// define the item component
    Vue.component('item', {
    	template: '#tree-template',
        props: { model: Object, level: Number },
        data: function () {
    		return {
    			open: false
            };
        },
        computed: {
    		isFolder: function () {
                return this.model.children && this.model.children.length;
	        },
            distStyle: function () {
    			return function (level) {
    				return {
    					'padding-left': level * 32 + 'px'
                    };
                };
            }
        },
        methods: {
    		toggle: function () {
    			if (this.isFolder) {
    				this.open = !this.open;
                }
            },
            changeType: function () {
    			if (!this.isFolder) {
    				Vue.set(this.model, 'children', []);
    				this.addChild();
    				this.open = true;
                }
            },
            addChild: function () {
    			var level = this.level;

    			this.model.children.push({
    				name: 'new stuff-' + level
                });
            }
        }
    });

	var demo = new Vue({
		el: '#demo',
        data: {
			treeData: data
        }
    });
</script>